var h11DieSizeDict = {
    '130': ['130', 0],
    '150': ['150', 0],
    '180': ['180', 0],
    '198': ['200', 0],
    '200': ['200', 0],
    '204': ['204', 0],
    '211': ['211', 0],
    '216': ['216', 0],
    '220': ['220', 0],
    '225': ['225', 0],
    '227': ['230', 0],
    '228': ['230', 0],
    '229': ['230', 0],
    '230': ['230', 0],
    '234': ['235', 0],
    '235': ['235', 0],
    '237': ['240', 0],
    '240': ['240', 0],
    '241': ['240', 0],
    '246': ['246', 0],
    '250': ['250', 0],
    '254': ['255', 0],
    '255': ['255', 0],
    '260': ['260', 0],
    '265': ['265', 0],
    '270': ['270', 0],
    '273': ['275', 0],
    '275': ['275', 0],
    '279': ['280', 0],
    '280': ['280', 0],
    '285': ['285', 0],
    '289': ['290', 0],
    '290': ['290', 0],
    '298': ['300', 0],
    '300': ['300', 0],
    '305': ['305', 0],
    '310': ['310', 0],
    '315': ['315', 0],
    '320': ['320', 0],
    '325': ['325', 0],
    '328': ['330', 0],
    '330': ['300', 0],
}

var h13DieSizeDict = {
    '130': ['130', 0],
    '150': ['150', 0],
    '180': ['180', 0],
    '198': ['200', 0],
    '200': ['200', 0],
    '204': ['204', 0],
    '211': ['211', 0],
    '216': ['216', 0],
    '220': ['220', 0],
    '225': ['225', 0],
    '227': ['230', 0],
    '228': ['230', 0],
    '229': ['230', 0],
    '230': ['230', 0],
    '234': ['235', 0],
    '235': ['235', 0],
    '237': ['240', 0],
    '240': ['240', 0],
    '241': ['240', 0],
    '246': ['246', 0],
    '250': ['250', 0],
    '254': ['255', 0],
    '255': ['255', 0],
    '260': ['260', 0],
    '265': ['265', 0],
    '270': ['270', 0],
    '273': ['275', 0],
    '275': ['275', 0],
    '279': ['280', 0],
    '280': ['280', 0],
    '285': ['285', 0],
    '289': ['290', 0],
    '290': ['290', 0],
    '298': ['300', 0],
    '300': ['300', 0],
    '305': ['305', 0],
    '310': ['310', 0],
    '315': ['315', 0],
    '320': ['320', 0],
    '325': ['325', 0],
    '328': ['330', 0],
    '330': ['300', 0],
}

var s2714DieSizeDict = {
    '130': ['130', 0],
    '150': ['150', 0],
    '180': ['180', 0],
    '198': ['200', 0],
    '200': ['200', 0],
    '204': ['204', 0],
    '211': ['211', 0],
    '216': ['216', 0],
    '220': ['220', 0],
    '225': ['225', 0],
    '227': ['230', 0],
    '228': ['230', 0],
    '229': ['230', 0],
    '230': ['230', 0],
    '234': ['235', 0],
    '235': ['235', 0],
    '237': ['240', 0],
    '240': ['240', 0],
    '241': ['240', 0],
    '246': ['246', 0],
    '250': ['250', 0],
    '254': ['255', 0],
    '255': ['255', 0],
    '260': ['260', 0],
    '265': ['265', 0],
    '270': ['270', 0],
    '273': ['275', 0],
    '275': ['275', 0],
    '279': ['280', 0],
    '280': ['280', 0],
    '285': ['285', 0],
    '289': ['290', 0],
    '290': ['290', 0],
    '298': ['300', 0],
    '300': ['300', 0],
    '305': ['305', 0],
    '310': ['310', 0],
    '315': ['315', 0],
    '320': ['320', 0],
    '325': ['325', 0],
    '328': ['330', 0],
    '330': ['300', 0],
}

// var h11Dict = {
//     '130': 0,
//     '150': 0,
//     '180': 0,
//     '200': 0,
//     '204': 0,
//     '211': 0,
//     '216': 0,
//     '220': 0,
//     '225': 0,
//     '230': 0,
//     '235': 0,
//     '240': 0,
//     '246': 0,
//     '250': 0,
//     '255': 0,
//     '260': 0,
//     '265': 0,
//     '270': 0,
//     '275': 0,
//     '280': 0,
//     '285': 0,
//     '290': 0,
//     '300': 0,
//     '305': 0,
//     '310': 0,
//     '315': 0,
//     '320': 0,
//     '325': 0,
//     '330': 0,
// }

// var h13Dict = {
//     '130': 0,
//     '150': 0,
//     '180': 0,
//     '200': 0,
//     '204': 0,
//     '211': 0,
//     '216': 0,
//     '220': 0,
//     '225': 0,
//     '230': 0,
//     '235': 0,
//     '240': 0,
//     '246': 0,
//     '250': 0,
//     '255': 0,
//     '260': 0,
//     '265': 0,
//     '270': 0,
//     '275': 0,
//     '280': 0,
//     '285': 0,
//     '290': 0,
//     '300': 0,
//     '305': 0,
//     '310': 0,
//     '315': 0,
//     '320': 0,
//     '325': 0,
//     '330': 0,
// }

// var s2714Dict = {
//     '130': 0,
//     '150': 0,
//     '180': 0,
//     '200': 0,
//     '204': 0,
//     '211': 0,
//     '216': 0,
//     '220': 0,
//     '225': 0,
//     '230': 0,
//     '235': 0,
//     '240': 0,
//     '246': 0,
//     '250': 0,
//     '255': 0,
//     '260': 0,
//     '265': 0,
//     '270': 0,
//     '275': 0,
//     '280': 0,
//     '285': 0,
//     '290': 0,
//     '300': 0,
//     '305': 0,
//     '310': 0,
//     '315': 0,
//     '320': 0,
//     '325': 0,
//     '330': 0,
// }

let s2714Dict = {};
let h13Dict = {};
let h11Dict = {};
let s2714Array = [];
let h13Array = [];
let h11Array = [];
let s2714StockArray = [];
let h13StockArray = [];
let h11StockArray = [];

function checkAuth(){

    let userDict = {
        'james':'JT',
        'paul_w':'PW',
        'pete':'PeC',
        'derek':'DS',
        'russell_g':'RG',
        'paul_c':'PC',
        'mel':'MV',
        'jamie':'JM',
        'mark':'MD',
        'chubb':'TR',
        'scott': 'SM',
        'brian_j': 'BJ',
        'dene': 'DSu',
        'john':'JS', 
        'rob_l':'RL',
        'chris_t':'CT',
        'brian_p':'BP',
        'clive':'CC',
        'warren':'WP',
        'piotr':'PS',
        'bailey':'BA',
        'ryan':'RD',
        'russell_j':'RJ',
        'keenan':'KW',
        'jack':'JD',
        'joe':'JR',
        'tom':'TD',
        'harvey':'HW',
        'kyle':'KW',
        'adelajd':'AR'
    }

    console.log(document.getElementById('foot-container').innerText);
    let initial = userDict[document.getElementById('foot-container').innerText];

    console.log(initial);

    let authorisedUsers = ['JT', 'PW', 'PeC', 'PC', 'BJ', 'SM'];
    let i = 0;
    let authorised = false;

    while (i < authorisedUsers.length) {
        if(initial == (authorisedUsers[i])){
            authorised = true;
        }
        i++;
    }

    if(authorised == false){
        removeElements();
        let new_warning_message = document.createElement('h3');
        //let warningMessage = 'formHeader';
        //new_warning_message.className = warningMessage;
        document.getElementById('content-container').appendChild(new_warning_message);
    
        //Populate and append the form title. 
        warningMessage = 'You do not have permission to access this page '; 
        new_warning_message.appendChild(document.createTextNode(warningMessage));
        // Create line break
        let br = document.createElement('br');
        document.getElementById('content-container').appendChild(br.cloneNode());
    }
}



function getDatabase(){
    infoxhp = new XMLHttpRequest();
    infoxhp.open('GET', 'get_s2714_table.php', true);
    infoxhp.send();
    infoxhp.onreadystatechange = function(){
        if (this.readyState == 4 && this.status == 200){
            let data = JSON.parse(this.responseText);
            // for (i in data){
            //     s2714Array = [];

            //     s2714Array.push(data[i].stock);

            //     s2714Dict[data[i].size] = s2714Array;
            // }
            for (i in data){
                s2714Array = [];

                s2714Array.push(data[i].stock);

                s2714Dict[String(data[i].size)] = parseInt(data[i].stock);
            }
        }
    };

    lipxhp = new XMLHttpRequest();
    lipxhp.open('GET', 'get_h13_table.php', true);
    lipxhp.send();
    lipxhp.onreadystatechange = function(){
        if (this.readyState == 4 && this.status == 200){
            let data = JSON.parse(this.responseText);
            for (i in data){
            //     h13Array = [];

            //     h13Array.push(data[i].stock);

            //     h13Dict[data[i].size] = h13Array;
            // }
                h13Array = [];

                h13Array.push(data[i].stock);

                h13Dict[String(data[i].size)] = parseInt(data[i].stock);
            }
        }
    };

    mandxhp = new XMLHttpRequest();
    mandxhp.open('GET', 'get_h11_table.php', true);
    mandxhp.send();
    mandxhp.onreadystatechange = function(){
        if (this.readyState == 4 && this.status == 200){
            let data = JSON.parse(this.responseText);
            // for (i in data){
            //     h11Array = [];

            //     h11Array.push(data[i].stock);

            //     h11Dict[data[i].size] = h11Array;
            // }
            for (i in data){
                // h11Array = [];
                // h11StockArray = [];
                // console.log(i);

                // h11Array.push(data[i].size);
                // h11StockArray.push(data[i].stock);

                h11Dict[String(data[i].size)] = parseInt(data[i].stock);
            }
        }
    };
}

getDatabase();

function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
  
  async function demo() {
    console.log('Taking a break...');
    await sleep(750);
    console.log('Two seconds later, showing sleep in a loop...');
  
    // Sleep in loop
    for (let i = 0; i < 2; i++) {
      if (i === 3)
        await sleep(750);
      console.log(i);
    }

    populateH11Steel();
    populateH13Steel();
    populateS2714Steel();
    console.log(s2714Dict);
}
demo();



let steelType = '';
// insertAllH11Elements();



function removeElements(){
    const el = document.getElementById('content-container');
    while(el.firstChild) el.removeChild(el.firstChild);
}

// H11 FUNCTIONS 
let h11Button = document.getElementById('h11');
h11Button.addEventListener('click', insertAllH11Elements);

function populateH11Steel(){
    getDatabase();
    // For each bar size in the die size dictionary, find relative size in steel dictionary and copy current stock.
    for(key in h11DieSizeDict){
        let h11Key = h11DieSizeDict[key][0];
        h11DieSizeDict[key][1] = h11Dict[h11Key];
    }
}

function getNumberOfh11Sizes(){
    // Return the number of elements in the die size dictionary. 
    let count = 0;
    for (let i in h11DieSizeDict) {
        if (h11DieSizeDict.hasOwnProperty(i)){
            count++;
        }
    }
    return(count);
}

function insertAllH11Elements(){
    removeElements();
    console.log("here2");

    // Create container element for the list to appear in. 
    let new_div = document.createElement('div');
    let newClass ='steelListContainer';
    new_div.className = newClass;
    new_div.id = 'steelListContainer';
    document.getElementById('content-container').appendChild(new_div);

    //Work out how many entries are required
    steelType = 'H11';
    let amount = getNumberOfh11Sizes();
    let keyArray = [];
    let aKey = '';


    // Create 'Row' div that contains all of the elements for a specific entry
    for (let key in h11DieSizeDict){
        keyArray.push(key);
    }
    for(let i = 0; i < amount; i++){
        aKey = keyArray[i];
        let new_div = document.createElement('div');
        let newClass ='';
        //Alternate entries with light and dark backgrounds - this is done by alternating class type depending on iterator value.
        if(i%2 == 0){
            newClass = 'job-light';
        }
        else{
            newClass = 'job-dark';
        }
        new_div.className = newClass;        
        new_div.id = aKey;
        document.getElementById('steelListContainer').appendChild(new_div);

        // Create 'Column' divs for each element in an entry.  
        let dieDiaCont = document.createElement('div'); // Die Dia
        dieDiaCont.className = 'dieDiaCont';
        dieDiaCont.id = aKey + 'dieDiaCont';
        document.getElementById(aKey).appendChild(dieDiaCont);
        let textnode1 = document.createTextNode(aKey);
        document.getElementById(aKey + 'dieDiaCont').appendChild(textnode1);

        let barDiaCont = document.createElement('div'); // Bar Dia
        barDiaCont.className = 'barDiaCont';
        barDiaCont.id = aKey + 'barDiaCont';
        document.getElementById(aKey).appendChild(barDiaCont);
        let textnode2 = document.createTextNode(h11DieSizeDict[aKey][0]);
        document.getElementById(aKey + 'barDiaCont').appendChild(textnode2);

        let stockCont = document.createElement('div'); // Stock
        stockCont.className = 'stockCont';
        stockCont.id = aKey + 'stockCont';
        document.getElementById(aKey).appendChild(stockCont);
        let textnode3 = document.createTextNode(h11DieSizeDict[aKey][1]);
        document.getElementById(aKey + 'stockCont').appendChild(textnode3);
    }  
    addJobListeners();
    console.log("fuckywucky");
    checkAuth();
}

//END OF H11 FUNCTIONS

// H13 FUNCTIONS
let h13Button = document.getElementById('h13');
h13Button.addEventListener('click', insertAllH13Elements);

function populateH13Steel(){
    getDatabase();
    // For each bar size in the die size dictionary, find relative size in steel dictionary and copy current stock.
    for(key in h13DieSizeDict){
        let h13Key = h13DieSizeDict[key][0];
        h13DieSizeDict[key][1] = h13Dict[h13Key];
    }
}

function getNumberOfh13Sizes(){
    // Return the number of elements in the die size dictionary.
    let count = 0;
    for (let i in h13DieSizeDict) {
        if (h13DieSizeDict.hasOwnProperty(i)){
            count++;
        }
    }
    return(count);
}

function insertAllH13Elements(){
    removeElements();

    // Create container element for the list to appear in. 
    let new_div = document.createElement('div');
    let newClass ='steelListContainer';
    new_div.className = newClass;
    new_div.id = 'steelListContainer';
    document.getElementById('content-container').appendChild(new_div);

    //Work out how many entries are required
    steelType = 'H13';
    let amount = getNumberOfh13Sizes();
    let keyArray = [];
    let aKey = '';

    // Create 'Row' div that contains all of the elements for a specific entry   
    for (let key in h13DieSizeDict){
        keyArray.push(key);
    }
    for(let i = 0; i < amount; i++){
        aKey = keyArray[i];
        let new_div = document.createElement('div');
        let newClass ='';
        //Alternate entries with light and dark backgrounds - this is done by alternating class type depending on iterator value.
        if(i%2 == 0){
            newClass = 'job-light';
        }
        else{
            newClass = 'job-dark';
        }
        new_div.className = newClass;        
        new_div.id = aKey;
        document.getElementById('steelListContainer').appendChild(new_div);

        // Create 'Column' divs for each element in an entry.  
        let dieDiaCont = document.createElement('div'); // Die Dia
        dieDiaCont.className = 'dieDiaCont';
        dieDiaCont.id = aKey + 'dieDiaCont';
        document.getElementById(aKey).appendChild(dieDiaCont);
        let textnode1 = document.createTextNode(aKey);
        document.getElementById(aKey + 'dieDiaCont').appendChild(textnode1);

        let barDiaCont = document.createElement('div'); // Bar Dia
        barDiaCont.className = 'barDiaCont';
        barDiaCont.id = aKey + 'barDiaCont';
        document.getElementById(aKey).appendChild(barDiaCont);
        let textnode2 = document.createTextNode(h13DieSizeDict[aKey][0]);
        document.getElementById(aKey + 'barDiaCont').appendChild(textnode2);

        let stockCont = document.createElement('div'); // Stock
        stockCont.className = 'stockCont';
        stockCont.id = aKey + 'stockCont';
        document.getElementById(aKey).appendChild(stockCont);
        let textnode3 = document.createTextNode(h13DieSizeDict[aKey][1]);
        document.getElementById(aKey + 'stockCont').appendChild(textnode3);

    }  
    addJobListeners();
    checkAuth();
}

// END OF H13 FUNCTIONS

// S2714 FUNCTIONS
let s2714Button = document.getElementById('s2714');
s2714Button.addEventListener('click', insertAlls2714Elements);

function populateS2714Steel(){
    getDatabase();
    // For each bar size in the die size dictionary, find relative size in steel dictionary and copy current stock.
    for(key in s2714DieSizeDict){
        let s2714Key = s2714DieSizeDict[key][0];
        s2714DieSizeDict[key][1] = s2714Dict[s2714Key];
    }
}

function getNumberOfs2714Sizes(){
    // Return the number of elements in the die size dictionary.
    let count = 0;
    for (let i in s2714DieSizeDict) {
        if (s2714DieSizeDict.hasOwnProperty(i)){
            count++;
        }
    }
    return(count);
}

function insertAlls2714Elements(){
    removeElements();


    // Create container element for the list to appear in. 
    var new_div = document.createElement('div');
    let newClass ='steelListContainer';
    new_div.className = newClass;
    new_div.id = 'steelListContainer';
    document.getElementById('content-container').appendChild(new_div);

    //Work out how many entries are required
    steelType = 's2714';
    let amount = getNumberOfs2714Sizes();
    let keyArray = [];
    let aKey = '';

    // Create 'Row' div that contains all of the elements for a specific entry
    for (let key in s2714DieSizeDict){
        keyArray.push(key);
    }
    //Alternate entries with light and dark backgrounds - this is done by alternating class type depending on iterator value.
    for(let i = 0; i < amount; i++){
        aKey = keyArray[i];
        let new_div = document.createElement('div');
        let newClass ='';
        if(i%2 == 0){
            newClass = 'job-light';
        }
        else{
            newClass = 'job-dark';
        }
        new_div.className = newClass;        
        new_div.id = aKey;
        document.getElementById('steelListContainer').appendChild(new_div);

        // Create 'Column' divs for each element in an entry.  
        let dieDiaCont = document.createElement('div'); // Die Dia
        dieDiaCont.className = 'dieDiaCont';
        dieDiaCont.id = aKey + 'dieDiaCont';
        document.getElementById(aKey).appendChild(dieDiaCont);
        let textnode1 = document.createTextNode(aKey);
        document.getElementById(aKey + 'dieDiaCont').appendChild(textnode1);

        let barDiaCont = document.createElement('div'); // Bar Dia
        barDiaCont.className = 'barDiaCont';
        barDiaCont.id = aKey + 'barDiaCont';
        document.getElementById(aKey).appendChild(barDiaCont);
        let textnode2 = document.createTextNode(s2714DieSizeDict[aKey][0]);
        document.getElementById(aKey + 'barDiaCont').appendChild(textnode2);

        let stockCont = document.createElement('div'); // Stock
        stockCont.className = 'stockCont';
        stockCont.id = aKey + 'stockCont';
        document.getElementById(aKey).appendChild(stockCont);
        let textnode3 = document.createTextNode(s2714DieSizeDict[aKey][1]);
        document.getElementById(aKey + 'stockCont').appendChild(textnode3);  

    }  
    addJobListeners();
    checkAuth();
}

// END OF S2714 FUNCTIONS

function addJobListeners(){
    //Loop through every light and dark job element and add an event lister to each one to wait for clicks.
    let clickedIdLight = document.getElementsByClassName('job-light');
    for (let i = 0; i < clickedIdLight.length; i++){
        clickedIdLight[i].addEventListener('click', getClickedId);
    }
    let clickedIdDark = document.getElementsByClassName('job-dark');
    for (let i = 0; i < clickedIdDark.length; i++){
        clickedIdDark[i].addEventListener('click', getClickedId);
    }
}

function getClickedId(){
    // Pass id of clicked job div to the update form creation function
    createUpdateForm(this.id);
}

function returnClickedId(anId){
    // For testing only
    console.log(anId);
} 

function createUpdateForm(anId){
    removeElements();

    // Create container for form
    let new_div = document.createElement('div');
    let newClass ='steelFormContainer';
    new_div.className = newClass;
    new_div.id = 'steelFormContainer';
    document.getElementById('content-container').appendChild(new_div);

    //Create title for the form
    let new_header = document.createElement('h3');
    let headerClass = 'formHeader';
    new_header.className = headerClass;
    document.getElementById('steelFormContainer').appendChild(new_header);
    let sub_header = document.createElement('h3');
    sub_header.className = headerClass;
    document.getElementById('steelFormContainer').appendChild(sub_header);

    //Set stock dictionary to use based on the steel type
    let aDict = '';
    let barSize = '';
    let stockLevel = '';
    if (steelType == 'H11'){
        aDict = 'h11DieSizeDict';
        anId += '';
        barSize = h11DieSizeDict[anId][0];
        stockLevel = h11DieSizeDict[anId][1];
    }
    else if (steelType == 'H13'){
        aDict = 'h13DieSizeDict';
        anId += '';
        barSize = h13DieSizeDict[anId][0];
        stockLevel = h13DieSizeDict[anId][1];
    }
    else if (steelType == 's2714'){
        aDict = 's2714DieSizeDict';
        anId += '';
        barSize = s2714DieSizeDict[anId][0];
        stockLevel = s2714DieSizeDict[anId][1];
    }
    //Populate and append the form title. 
    headerString = 'Steel Type: ' + steelType + ' - Die Dia: ' + anId ; 
    new_header.appendChild(document.createTextNode(headerString));
    // Create line break
    let br = document.createElement('br');
    document.getElementById('steelFormContainer').appendChild(br.cloneNode());
    subHeaderString = 'Bar Size: ' + barSize + ' - Stock: ' + stockLevel + 'mm'; 
    sub_header.appendChild(document.createTextNode(subHeaderString));

    // Create an array of select options
    let selectArray = ['Book Steel Out', 'Book Steel In', 'Audit Steel Stock'];

    // Create a select option and append to document
    let selectList = document.createElement('select');
    selectList.id = 'transSelect';
    document.getElementById('steelFormContainer').appendChild(selectList);
    
    //Create and append the options
    for (let i = 0; i < selectArray.length; i++) {
        let option = document.createElement('option');
        option.value = selectArray[i];
        option.text = selectArray[i];
        selectList.appendChild(option);
    }
    
    document.getElementById('steelFormContainer').appendChild(br.cloneNode());

    // Create value field for selected option
    let valueInput = document.createElement('input');
    valueInput.setAttribute('type', 'text');
    valueInput.setAttribute('name', 'input');
    valueInput.setAttribute('placeholder', 'Enter amount (mm)');
    valueInput.id = 'valueInput';

    document.getElementById('steelFormContainer').appendChild(valueInput);

    // Create a button and an event listner that passes the values contained in the form to function that updates the correct dictionary. 
    document.getElementById('steelFormContainer').appendChild(br.cloneNode());
    let actionButton = document.createElement('button');
    actionButton.appendChild(document.createTextNode('Submit'));
    actionButton.addEventListener('click', function() {changeSteelDict(anId, document.getElementById('transSelect').value, document.getElementById('valueInput').value)});
    document.getElementById('steelFormContainer').appendChild(actionButton);

}

function changeSteelDict(anId, transType, aValue){
    let aDict = '';
    let entry = '';

    if (steelType == 'H11'){
        aDict = 'h11DieSizeDict';
        entry = h11DieSizeDict[anId][0];
        transType += '';
        entry += '';
        aValue = parseInt(aValue);
        if(transType == 'Book Steel Out'){
            h11Dict[entry] -= aValue;
        }
        else if (transType == 'Book Steel In'){
            h11Dict[entry] += aValue;
        }
        else if (transType == 'Audit Steel Stock'){
            h11Dict[entry] = aValue;
        }
        h11String = 'size=' + entry +'&stock=' + h11Dict[entry];
        console.log(h11String);
        callPHP(h11String,'update_h11.php?'+h11String);
        populateH11Steel();
        removeElements();
        insertAllH11Elements()
    }
    else if (steelType == 'H13'){
        aDict = 'h13DieSizeDict';
        entry = h13DieSizeDict[anId][0];
        transType += '';
        entry += '';
        aValue = parseInt(aValue);
        if(transType == 'Book Steel Out'){
            h13Dict[entry] -= aValue;
        }
        else if (transType == 'Book Steel In'){
            h13Dict[entry] += aValue;
        }
        else if (transType == 'Audit Steel Stock'){
            h13Dict[entry] = aValue;
        }
        h13String = 'size=' + entry +'&stock=' + h13Dict[entry];
        callPHP(h13String,'update_h13.php?'+h13String);
        populateH13Steel();
        removeElements();
        insertAllH13Elements()
    }
    else if (steelType == 's2714'){
        aDict = 's2714DieSizeDict';
        entry = s2714DieSizeDict[anId][0];
        transType += '';
        entry += '';
        aValue = parseInt(aValue);
        if(transType == 'Book Steel Out'){
            s2714Dict[entry] -= aValue;
        }
        else if (transType == 'Book Steel In'){
            s2714Dict[entry] += aValue;
        }
        else if (transType == 'Audit Steel Stock'){
            s2714Dict[entry] = aValue;
        }
        s2714String = 'size=' + entry +'&stock=' + s2714Dict[entry];
        callPHP(s2714String,'update_s2714.php?'+s2714String);
        populateS2714Steel();
        removeElements();
        insertAlls2714Elements();
    }

}

function callPHP(params, aurl) {
    var httpc = new XMLHttpRequest(); // simplified for clarity
    var url = aurl;
    httpc.open("GET", url, true); // sending as POST

    httpc.onreadystatechange = function() { //Call a function when the state changes.
        if(httpc.readyState == 4 && httpc.status == 200) { // complete and no errors
            // alert(httpc.responseText); // some processing here, or whatever you want to do with the response
        }
    };
    httpc.send(params);
}

checkAuth();
console.log("here2");